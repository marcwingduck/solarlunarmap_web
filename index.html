<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Paris Solar Map</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="resources/favicon.png">
</head>

<body>
    <div class="container-fluid col-lg-6 mt-2 ">

        <!--header-->
        <div class="mx-auto card bg-dark text-white">
            <h3>Celestial Map <span class="badge badge-secondary" id="status"></span></h3>

            <!--<h5>Power <span class="badge badge-secondary" id="plugStatus"></span></h5>
                <div class="form-group">
                    <input type="text" class="form-control" id="plugURL" value="http://192.168.0.223/">
                    <div class="btn-group d-flex">
                        <button class="btn btn-secondary" type="button" id="power_on">On</button>
                        <button class="btn btn-secondary" type="button" id="power_off">Off</button>
                    </div>
                </div>-->

            <form>
                <div class="row">
                    <div class="col">
                        <input type="text" class="form-control" id="boardURL" value="ws://192.168.0.188:8266/">
                    </div>
                    <div class="col">
                        <input type="password" class="form-control" id="password" placeholder="Password">
                    </div>
                </div>
                <div class="btn-group d-flex">
                    <button class="btn btn-secondary w-100" type="button" id="open">Open</button>
                    <button class="btn btn-secondary w-100" type="button" id="close">Close</button>
                </div>
            </form>

            <div class="btn-group" role="group">
                <button class="btn btn-dark w-100" type="button" id="btn-solunar">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sunrise-fill" viewBox="0 0 16 16">
                        <path d="M7.646 1.146a.5.5 0 0 1 .708 0l1.5 1.5a.5.5 0 0 1-.708.708L8.5 2.707V4.5a.5.5 0 0 1-1 0V2.707l-.646.647a.5.5 0 1 1-.708-.708l1.5-1.5zM2.343 4.343a.5.5 0 0 1 .707 0l1.414 1.414a.5.5 0 0 1-.707.707L2.343 5.05a.5.5 0 0 1 0-.707zm11.314 0a.5.5 0 0 1 0 .707l-1.414 1.414a.5.5 0 1 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zM11.709 11.5a4 4 0 1 0-7.418 0H.5a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1h-3.79zM0 10a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2A.5.5 0 0 1 0 10zm13 0a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-clock">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock" viewBox="0 0 16 16">
                        <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-clock2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-ambient">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cloud-moon-fill" viewBox="0 0 16 16">
                        <path d="M11.473 11a4.5 4.5 0 0 0-8.72-.99A3 3 0 0 0 3 16h8.5a2.5 2.5 0 0 0 0-5h-.027z" />
                        <path d="M11.286 1.778a.5.5 0 0 0-.565-.755 4.595 4.595 0 0 0-3.18 5.003 5.46 5.46 0 0 1 1.055.209A3.603 3.603 0 0 1 9.83 2.617a4.593 4.593 0 0 0 4.31 5.744 3.576 3.576 0 0 1-2.241.634c.162.317.295.652.394 1a4.59 4.59 0 0 0 3.624-2.04.5.5 0 0 0-.565-.755 3.593 3.593 0 0 1-4.065-5.422z" />
                    </svg>
                </button>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-dark w-100" type="button" id="btn-vertical">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-expand" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M3.646 10.146a.5.5 0 0 1 .708 0L8 13.793l3.646-3.647a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 0-.708zm0-4.292a.5.5 0 0 0 .708 0L8 2.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708zM1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-horizontal">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-expand" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="m 5.854,3.646 a 0.5,0.5 0 0 1 0,0.708 L 2.207,8 5.854,11.646 a 0.5006316,0.5006316 0 0 1 -0.708,0.708 l -4,-4 a 0.5,0.5 0 0 1 0,-0.708 l 4,-4 a 0.5,0.5 0 0 1 0.708,0 z m 4.292,0 a 0.5,0.5 0 0 0 0,0.708 L 13.793,8 10.146,11.646 a 0.5006316,0.5006316 0 0 0 0.708,0.708 l 4,-4 a 0.5,0.5 0 0 0 0,-0.708 l -4,-4 a 0.5,0.5 0 0 0 -0.708,0 z M 8,1 a 0.5,0.5 0 0 1 0.5,0.5 v 13 a 0.5,0.5 0 0 1 -1,0 V 1.5 A 0.5,0.5 0 0 1 8,1 Z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-circle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-circle" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-square">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-square" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                    </svg>
                </button>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-dark w-100" type="button" id="btn-larson">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-car-front-fill" viewBox="0 0 16 16">
                        <path d="M2.52 3.515A2.5 2.5 0 0 1 4.82 2h6.362c1 0 1.904.596 2.298 1.515l.792 1.848c.075.175.21.319.38.404.5.25.855.715.965 1.262l.335 1.679c.033.161.049.325.049.49v.413c0 .814-.39 1.543-1 1.997V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.338c-1.292.048-2.745.088-4 .088s-2.708-.04-4-.088V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.892c-.61-.454-1-1.183-1-1.997v-.413a2.5 2.5 0 0 1 .049-.49l.335-1.68c.11-.546.465-1.012.964-1.261a.807.807 0 0 0 .381-.404l.792-1.848ZM3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm10 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6 8a1 1 0 0 0 0 2h4a1 1 0 1 0 0-2H6ZM2.906 5.189a.51.51 0 0 0 .497.731c.91-.073 3.35-.17 4.597-.17 1.247 0 3.688.097 4.597.17a.51.51 0 0 0 .497-.731l-.956-1.913A.5.5 0 0 0 11.691 3H4.309a.5.5 0 0 0-.447.276L2.906 5.19Z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-random">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dice-6-fill" viewBox="0 0 16 16">
                        <path d="M3 0a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V3a3 3 0 0 0-3-3H3zm1 5.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm8 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm1.5 6.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM12 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM5.5 12a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM4 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-spin">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z" />
                        <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z" />
                    </svg>
                </button>
                <button class="btn btn-dark w-100" type="button" id="btn-focus">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lamp-fill" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M5.04.303A.5.5 0 0 1 5.5 0h5c.2 0 .38.12.46.303l3 7a.5.5 0 0 1-.363.687h-.002c-.15.03-.3.056-.45.081a32.731 32.731 0 0 1-4.645.425V13.5a.5.5 0 1 1-1 0V8.495a32.753 32.753 0 0 1-4.645-.425c-.15-.025-.3-.05-.45-.08h-.003a.5.5 0 0 1-.362-.688l3-7Z" />
                        <path d="M6.493 12.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.319 1.319 0 0 0-.37.265.301.301 0 0 0-.052.075l-.001.004-.004.01V14l.002.008a.147.147 0 0 0 .016.033.62.62 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.62.62 0 0 0 .146-.15.148.148 0 0 0 .015-.033L12 14v-.004a.301.301 0 0 0-.057-.09 1.318 1.318 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465-1.281 0-2.462-.172-3.34-.465-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411Z" />
                    </svg>
                </button>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-dark w-100" type="button" id="btn-sleep">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb-off" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M2.23 4.35A6.004 6.004 0 0 0 2 6c0 1.691.7 3.22 1.826 4.31.203.196.359.4.453.619l.762 1.769A.5.5 0 0 0 5.5 13a.5.5 0 0 0 0 1 .5.5 0 0 0 0 1l.224.447a1 1 0 0 0 .894.553h2.764a1 1 0 0 0 .894-.553L10.5 15a.5.5 0 0 0 0-1 .5.5 0 0 0 0-1 .5.5 0 0 0 .288-.091L9.878 12H5.83l-.632-1.467a2.954 2.954 0 0 0-.676-.941 4.984 4.984 0 0 1-1.455-4.405l-.837-.836zm1.588-2.653.708.707a5 5 0 0 1 7.07 7.07l.707.707a6 6 0 0 0-8.484-8.484zm-2.172-.051a.5.5 0 0 1 .708 0l12 12a.5.5 0 0 1-.708.708l-12-12a.5.5 0 0 1 0-.708z" />
                    </svg>
                </button>
            </div>
            <div class="row flex-nowrap no-gutters">
                <input type="range" class="form-control-range" id="dimmer" min=0 max=1 step=0.02 value=0.5>
            </div>
        </div>
    </div>

    <!--image and color buttons-->
    <div class="container-fluid col-lg-8 mt-4 mb-4">
        <!--row 1 north brightness-->
        <div class="row flex-nowrap no-gutters">
            <div class="col-8 offset-2">
                <input type="range" class="form-control-range" id="wnorth" min=0 max=255 value=0>
            </div>
        </div>
        <!--row 2 north color-->
        <div class="row flex-nowrap no-gutters">
            <div class="col-8 offset-2 color-picker-wrapper">
                <input type="color" class="form-control" id="rgbnorth" value="#00ffff">
            </div>
            <div class="col"></div>
        </div>
        <!--row 3 west brightness/color, main image, east color/brightness-->
        <div class="row flex-nowrap no-gutters">
            <div class="col">
                <div class="vertical-slider-container">
                    <input type="range" class="form-control-range vertical-slider" id="wwest" min=0 max=255 value=0>
                </div>
            </div>
            <div class="col color-picker-wrapper">
                <input type="color" class="form-control" id="rgbwest" value="#00ff00">
            </div>
            <div class="col-8">
                <img class="img-fluid" src="resources/paris.jpg">
            </div>
            <div class="col color-picker-wrapper">
                <input type="color" class="form-control" id="rgbeast" value="#ffff00">
            </div>
            <div class="col">
                <div class="vertical-slider-container">
                    <input type="range" class="form-control-range vertical-slider" id="weast" min=0 max=255 value=0>
                </div>
            </div>
        </div>
        <!--row 4 south color-->
        <div class="row flex-nowrap no-gutters">
            <div class="col-8 offset-2 color-picker-wrapper" id="south-view">
                <input type="color" class="form-control" id="rgbsouth" value="#ff00ff">
            </div>
            <div class="col"></div>
        </div>
        <!--row 5 south brightness-->
        <div class="row flex-nowrap no-gutters">
            <div class="col-8 offset-2">
                <input type="range" class="form-control-range" id="wsouth" min=0 max=255 value=0>
            </div>
            <div class="col"></div>
        </div>
    </div>

    <!--buttons-->
    <div class="container-fluid col-lg-6 text-center">

        <h4 class="text-white mt-4" data-toggle="collapse" data-target="#collapseDynamic" aria-expanded="false" aria-controls="collapseDynamic">
            Parameters
        </h4>

        <div class="collapse" id="collapseDynamic">
            <div class="input-form form-inline">
                <label for="clk_continuous"><span class="input-group-text">Continuous</span></label>
                <input type="checkbox" id="clk_continuous" class="form-control" />
            </div>
            <div class="input-form form-inline">
                <label for="clk_start_at_minute"><span class="input-group-text">Start at Minute Hand</span></label>
                <input type="checkbox" id="clk_start_at_minute" class="form-control" checked />
            </div>
            <div class="input-form form-inline">
                <label for="clk_two_colors"><span class="input-group-text">Two Color Mode</span></label>
                <input type="checkbox" id="clk_two_colors" class="form-control" checked />
            </div>
            <div class="input-form form-inline">
                <label for="clk_ambient"><span class="input-group-text">Ambient Mode</span></label>
                <input type="checkbox" id="clk_ambient" class="form-control" checked />
            </div>
            <div class="input-group form-inline">
                <label for="frequency"><span class="input-group-text">Spin frequency</span></label>
                <input type="number" id="frequency" min="0" step="0.1" value="0.25" class="form-control" />
                <div class="input-group-append"><span class="input-group-text"> Hz</span></div>
            </div>
        </div>

        <h4 class="text-white mt-4" data-toggle="collapse" data-target="#collapseTests" aria-expanded="false" aria-controls="collapseTests">
            Tests
        </h4>

        <div class="collapse" id="collapseTests">
            <div class="input-group form-inline w-100">
                <div class="input-group-prepend">
                    <button class="code-btn btn btn-dark text-left" type="button">test_led({index})</button>
                </div>
                <input type="number" id="index" min="0" max="179" step="1" value="0" class="form-control" />
            </div>
            <div class="btn-group-vertical w-100" role="group">
                <button class="code-btn btn btn-dark text-left" type="button">cycle_channels()</button>
                <button class="code-btn btn btn-dark text-left" type="button">cycle_color({north})</button>
                <button class="code-btn btn btn-dark text-left" type="button">cycle_circular(10)</button>
                <button class="code-btn btn btn-dark text-left" type="button">solunar_demo()</button>
                <button class="code-btn btn btn-dark text-left" type="button">clock_demo()</button>
            </div>
        </div>

    </div>
</body>

<script src="js/jquery-3.7.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>

<script>
    var ws = null;

    function webreplConnect(url, password, onConnect, onError) {
        ws = new WebSocket(url);
        ws.onopen = function () {
            ws.onmessage = function (e) {
            }
            ws.send(password + '\r\n');
            ws.send('\x03');
            updateStatus(ws);
        };
        ws.onclose = function (e) {
            updateStatus(ws);
        }
        ws.onerror = function (e) {
            updateStatus(ws);
        };
    }

    function hex2rgb(hex, w) {
        hex = hex.slice(1);
        var bigint = parseInt(hex, 16);
        var r = (bigint >> 16) & 255;
        var g = (bigint >> 8) & 255;
        var b = bigint & 255;
        return '(' + [g, r, b, w].join() + ')';
    }

    function updateStatus() {
        if (!ws) {
            $('#status').text("null");
        } else if (ws.readyState == ws.OPEN) {
            $('#status').text("Open");
        } else if (ws.readyState == ws.CLOSED) {
            $('#status').text("Closed");
        } else {
            $('#status').text("¯\\_(ツ)_/¯");
        }
    }

    function resizeVerticalSliders() {
        $('#wwest').css('width', $('#wwest').parent().height());
        $('#wwest').css('height', $('#wwest').parent().width());
        var px = $('#wwest').parent().width() / 2;
        var py = $('#wwest').parent().height() / 2;
        $('#wwest').css('left', px - py).css('top', py - px);

        $('#weast').css('width', $('#weast').parent().height());
        $('#weast').css('height', $('#weast').parent().width());
        var px = $('#weast').parent().width() / 2;
        var py = $('#weast').parent().height() / 2;
        $('#weast').css('left', px - py).css('top', py - px);
    }

    function connect() {
        var boardURL = $('#boardURL').val();
        var password = $('#password').val();
        webreplConnect(boardURL, password);
    }

    function updateColor(object) {
        var direction = "";

        if (object.id == "rgbnorth") {
            direction = "to top";
        }
        else if (object.id == "rgbeast") {
            direction = "to right";
        }
        else if (object.id == "rgbsouth") {
            direction = "to bottom";
        }
        else if (object.id == "rgbwest") {
            direction = "to left";
        }

        $(object).parent().css("background-image", "linear-gradient(" + direction + "," + object.value + ", rgba(0,0,0,0))");
    }

    function updatePlugStatus(status) {
    }

    function powerPlug(power) {

        var xhr = new XMLHttpRequest();
        const method = "GET";
        var url = $('#plugURL').val() + 'cm?cmnd=Power ' + power;

        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                $('#plugStatus').text(xhr.responseText);
            }
        };
        xhr.open(method, url, true);
        xhr.send();
    }

    function getColor(cardinal) {
        return hex2rgb($('#rgb' + cardinal).val(), parseInt($('#w' + cardinal).val()));
    }

    function parseAndExec(text) {

        // cardinals
        var n = getColor('north');
        var e = getColor('east');
        var s = getColor('south');
        var w = getColor('west');

        // frequency
        var f = parseFloat($('#frequency').val());

        // index
        var i = parseFloat($('#index').val());

        // replace placeholder
        fn = text
            .replace('{north}', n)
            .replace('{east}', e)
            .replace('{south}', s)
            .replace('{west}', w)
            .replace('{frequency}', f)
            .replace('{index}', i);

        // send
        if (ws) {
            ws.send('paris.stop_timer()\r\n'); // just in case
            ws.send('paris.' + fn + '\r\n');
        }
    }

    $(document).ready(function () {
        updateStatus(ws);

        $('#password').val('pvris');
        $('#password').keypress(function (event) {
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if (keycode == '13') {
                connect();
            }
        });

        $('#open').click(function () {
            connect()
        });

        $('#close').click(function () {
            if (ws) {
                ws.close();
            }
        });

        connect();

        $('#power_on').click(function () {
            powerPlug(1)
        });

        $('#power_off').click(function () {
            powerPlug(0);
        });

        $('.code-btn').click(function () {
            parseAndExec($(this).text());
        });

        $('#btn-solunar').click(function () {
            if (ws) {
                ws.send('paris.run_solunar()\r\n');
            }
        });

        $('#btn-clock').click(function () {
            var continuous = $('#clk_continuous').is(':checked') ? 'True' : 'False';
            if (ws) {
                ws.send('paris.run_cls_clock(' + continuous + ')\r\n');
            }
        });

        $('#btn-clock2').click(function () {
            var start_at_minute = $('#clk_start_at_minute').is(':checked') ? 'True' : 'False';
            var two_colors = $('#clk_two_colors').is(':checked') ? 'True' : 'False';
            var ambient = $('#clk_ambient').is(':checked') ? 'True' : 'False';
            if (ws) {
                ws.send('paris.run_neo_clock(' + start_at_minute + ',' + two_colors + ',' + ambient + ')\r\n');
            }
        });

        $('#btn-ambient').click(function () {
            if (ws) {
                ws.send('paris.stop_timer()\r\n');
                ws.send("paris.ambient()\r\n");
            }
        });

        $('#btn-focus').click(function () {
            if (ws) {
                ws.send('paris.stop_timer()\r\n');
                ws.send('paris.set_sides((0,32,127,0),(0,32,127,0),(0,0,0,127),(0,32,127,0),False)\r\n');
            }
        });

        $('#btn-vertical').click(function () {
            var fn = 'set_sides(' + getColor('north') + ',(0,0,0,0),' + getColor('south') + ',(0,0,0,0),True)';
            if (ws) {
                ws.send('paris.stop_timer()\r\n');
                ws.send('paris.' + fn + '\r\n');
            }
        });

        $('#btn-horizontal').click(function () {
            var fn = 'set_sides((0,0,0,0),' + getColor('east') + ',(0,0,0,0),' + getColor('west') + ',True)';
            if (ws) {
                ws.send('paris.stop_timer()\r\n');
                ws.send('paris.' + fn + '\r\n');
            }
        });

        $('#btn-circle').click(function () {
            if (ws) {
                ws.send('paris.stop_timer()\r\n');
            }
            parseAndExec('set_sides({north},{east},{south},{west}, False)');
        });

        $('#btn-square').click(function () {
            if (ws) {
                ws.send('paris.stop_timer()\r\n');
            }
            parseAndExec('set_sides({north},{east},{south},{west}, True)');
        });

        $('#btn-sleep').click(function () {
            if (ws) {
                ws.send('paris.stop_timer()\r\n');
                ws.send('paris.off()\r\n');
            }
        });

        $('#btn-larson').click(function () {
            parseAndExec('run_larson_scanner(\'south\', {north}, {south})');
        });

        $('#btn-random').click(function () {
            parseAndExec('run_random()');
        });

        $('#btn-spin').click(function () {
            parseAndExec('run_spin({north},{frequency})');
        });

        $('#dimmer').change(function (e) {
            if (ws) {
                ws.send('paris.apply_dimmer(' + e.target.value + ')\r\n');
            }
        });

        resizeVerticalSliders();

        var cardinals = "rgbnorth,rgbeast,rgbsouth,rgbwest";
        $.each(cardinals.split(','), function () {
            var color_picker = document.getElementById(this);
            updateColor(color_picker);
            color_picker.onchange = function () {
                updateColor(this);
            }
        })
    });

    $(window).on('resize', function () {
        resizeVerticalSliders();
    });
</script>

</html>